install.packages("spatialEco")
###############################################################################
## Project:       Simulate Surveys
## Author:        Zack Oyafuso (zack.oyafuso@noaa.gov)
## Description:   Simulate a Stratified Random Survey of the Gulf of
##                Alaska Groundfish Survey Based on Current Stratifications
###############################################################################
rm(list = ls())
##################################################
####   Import Libraries
##################################################
library(readxl)
library(spatialEco)
library(sp)
library(VAST)
##################################################
####   Set up directories
##################################################
which_machine <- c('Zack_MAC' = 1, 'Zack_PC' = 2, 'Zack_GI_PC' = 3)[3]
github_dir <- paste0(c("/Users/zackoyafuso/Documents/",
"C:/Users/Zack Oyafuso/Documents/",
"C:/Users/zack.oyafuso/Work/")[which_machine],
"GitHub/Optimal_Allocation_GoA/results/")
VAST_dir <- "G:/Oyafuso/VAST_Runs_EFH/Single_Species/"
##################################################
####   Load simulation functions
##################################################
source( paste0(dirname(github_dir), "/modified_functions/sim_fns.R") )
##################################
## Import Strata Allocations and spatial grid and predicted density
##################################
load(paste0(dirname(github_dir), '/data/optimization_data.RData'))
load(paste0(dirname(github_dir), '/data/RMSE_VAST_models.RData'))
load(paste0(dirname(github_dir), '/data/Extrapolation_depths.RData'))
load(paste0(dirname(github_dir), '/data/fit_density.RData'))
load(paste0(github_dir, "Spatiotemporal_Optimization",
"/optimization_knitted_results.RData"))
load(paste0(dirname(VAST_dir), "/sim_density.RData"))
GOA_allocations <- readxl::read_xlsx(
path = paste0(dirname(github_dir),
'/data/GOA 2019 stations by stratum.xlsx')
)
GOA_allocations3 <- readxl::read_xlsx(
path = paste0(dirname(github_dir),
'/data/GOA2019_ 3 boat_825_RNDM_stations.xlsx')
)
##################################################
####   Create dataframe of effort allocations across boats
##################################################
allocations <- data.frame(Stratum = sort(unique(GOA_allocations3$stratum)),
boat3 = aggregate(id ~ stratum,
data = GOA_allocations3,
FUN = length)$id,
boat2 = c(GOA_allocations$`Number stations`,
rep(0,5)))
allocations$boat1 <- ceiling(allocations$boat2 / 2)
allocations$boat1 <- ifelse(allocations$boat1 == 0, 0,
ifelse(allocations$boat1 == 1, 2,
allocations$boat1))
allocations <- rbind(data.frame(Stratum = 0, boat3 = 0, boat2 = 0, boat1 = 0),
allocations)
##################################################
####   Result Objects
##################################################
Current_sim_mean <- Current_sim_cv <- Current_rel_bias_est <-
STRS_sim_mean <- STRS_sim_cv <- STRS_rel_bias_est <-
array(dim = c(2, NTime, ns, nboats, Niters),
dimnames = list(c("pred_density", "plus_obs_error"),
paste0("year_", 1:NTime),
sci_names,
paste0("boat_", 1:3),
NULL ))
Current_true_cv_array <- Current_rrmse_cv_array <-
STRS_true_cv_array <- STRS_rrmse_cv_array <-
array(dim = c(2, NTime, ns, nboats),
dimnames = list(c("pred_density", "plus_obs_error"),
paste0("year_", 1:NTime),
sci_names,
paste0("boat_", 1:3)))
###############################################################################
## Project:       Simulate Surveys
## Author:        Zack Oyafuso (zack.oyafuso@noaa.gov)
## Description:   Simulate a Stratified Random Survey of the Gulf of
##                Alaska Groundfish Survey Based on Current Stratifications
###############################################################################
rm(list = ls())
##################################################
####   Import Libraries
##################################################
library(readxl)
library(spatialEco)
library(sp)
library(VAST)
##################################################
####   Set up directories
##################################################
which_machine <- c('Zack_MAC' = 1, 'Zack_PC' = 2, 'Zack_GI_PC' = 3)[1]
github_dir <- paste0(c("/Users/zackoyafuso/Documents/",
"C:/Users/Zack Oyafuso/Documents/",
"C:/Users/zack.oyafuso/Work/")[which_machine],
"GitHub/Optimal_Allocation_GoA/results/")
VAST_dir <- "G:/Oyafuso/VAST_Runs_EFH/Single_Species/"
##################################################
####   Load simulation functions
##################################################
source( paste0(dirname(github_dir), "/modified_functions/sim_fns.R") )
##################################
## Import Strata Allocations and spatial grid and predicted density
##################################
load(paste0(dirname(github_dir), '/data/optimization_data.RData'))
load(paste0(dirname(github_dir), '/data/RMSE_VAST_models.RData'))
load(paste0(dirname(github_dir), '/data/Extrapolation_depths.RData'))
load(paste0(dirname(github_dir), '/data/fit_density.RData'))
load(paste0(github_dir, "Spatiotemporal_Optimization",
"/optimization_knitted_results.RData"))
load(paste0(dirname(VAST_dir), "/sim_density.RData"))
GOA_allocations <- readxl::read_xlsx(
path = paste0(dirname(github_dir),
'/data/GOA 2019 stations by stratum.xlsx')
)
GOA_allocations3 <- readxl::read_xlsx(
path = paste0(dirname(github_dir),
'/data/GOA2019_ 3 boat_825_RNDM_stations.xlsx')
)
load(paste0(dirname(github_dir), '/data/optimization_data.RData'))
load(paste0(dirname(github_dir), '/data/RMSE_VAST_models.RData'))
load(paste0(dirname(github_dir), '/data/Extrapolation_depths.RData'))
load(paste0(dirname(github_dir), '/data/fit_density.RData'))
load(paste0(github_dir, "Spatiotemporal_Optimization",
"/optimization_knitted_results.RData"))
# load(paste0(dirname(VAST_dir), "/sim_density.RData"))
GOA_allocations <- readxl::read_xlsx(
path = paste0(dirname(github_dir),
'/data/GOA 2019 stations by stratum.xlsx')
)
GOA_allocations3 <- readxl::read_xlsx(
path = paste0(dirname(github_dir),
'/data/GOA2019_ 3 boat_825_RNDM_stations.xlsx')
)
##################################################
####   Create dataframe of effort allocations across boats
##################################################
allocations <- data.frame(Stratum = sort(unique(GOA_allocations3$stratum)),
boat3 = aggregate(id ~ stratum,
data = GOA_allocations3,
FUN = length)$id,
boat2 = c(GOA_allocations$`Number stations`,
rep(0,5)))
allocations$boat1 <- ceiling(allocations$boat2 / 2)
allocations$boat1 <- ifelse(allocations$boat1 == 0, 0,
ifelse(allocations$boat1 == 1, 2,
allocations$boat1))
allocations <- rbind(data.frame(Stratum = 0, boat3 = 0, boat2 = 0, boat1 = 0),
allocations)
##################################################
####   Result Objects
##################################################
Current_sim_mean <- Current_sim_cv <- Current_rel_bias_est <-
STRS_sim_mean <- STRS_sim_cv <- STRS_rel_bias_est <-
array(dim = c(2, NTime, ns, nboats, Niters),
dimnames = list(c("pred_density", "plus_obs_error"),
paste0("year_", 1:NTime),
sci_names,
paste0("boat_", 1:3),
NULL ))
Current_true_cv_array <- Current_rrmse_cv_array <-
STRS_true_cv_array <- STRS_rrmse_cv_array <-
array(dim = c(2, NTime, ns, nboats),
dimnames = list(c("pred_density", "plus_obs_error"),
paste0("year_", 1:NTime),
sci_names,
paste0("boat_", 1:3)))
##################################################
####   Result Objects
##################################################
Current_sim_mean <- Current_sim_cv <- Current_rel_bias_est <-
STRS_sim_mean <- STRS_sim_cv <- STRS_rel_bias_est <-
array(dim = c(2, NTime, ns_all, nboats, Niters),
dimnames = list(c("pred_density", "plus_obs_error"),
paste0("year_", 1:NTime),
sci_names_all,
paste0("boat_", 1:nboats),
NULL ))
Current_true_cv_array <- Current_rrmse_cv_array <-
STRS_true_cv_array <- STRS_rrmse_cv_array <-
array(dim = c(2, NTime, ns_all, nboats),
dimnames = list(c("pred_density", "plus_obs_error"),
paste0("year_", 1:NTime),
sci_names_all,
paste0("boat_", 1:nboats)))
iter = 1
